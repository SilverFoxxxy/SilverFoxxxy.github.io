<html>
<head>
    <meta charset="UTF-8">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

  <script src="https://vk.com/js/api/openapi.js?169" type="text/javascript"></script>

    <link rel="stylesheet" type="text/css" href="letters_reader.css"/>
    <title> Letters reader </title>
    <link rel="icon" href="src/icons/edit_icon.png" type="image/icon type">
</head>
<body>
<script src="src/http_req.js"></script>
<script src="src/text_edit_lib.js"></script>




















<div class="wideline">
<center>
    <div class="block" style="background: var(--main-bg); outline: none;">
    <table>
      <tr>
        <td style="width: fit-content">
          <button type="button" style="font-size: var(--def-fontsz); width: calc(var(--button-width) * 1); height:calc(var(--button-width) * 0.7);" id="login_button" onclick="showLoginForm()">
            <svg width="100%" height="100%">
              <svg id="login_icon" width="100%" height="100%" version="1.1" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
               <g fill="none" style="stroke: var(--main-color)">
                <path d="m5 95c0-22.427 18.838-38.136 45-38.127 26.162 0.0093 45 15.7 45 38.127" stroke-width="7"/>
                <circle cx="50" cy="27.5" r="22.5" stroke-width="7"/>
               </g>
              </svg>
              <!-- <use xlink:href="src/icons/login.svg#login_icon"></use> -->
            </svg>
            <!-- <img src="src/icons/login.svg" style='height: 100%; object-fit: contain;' id="login_icon"/>  -->
              
            </button>
        </td>

        <td style="width: fit-content; min-width: calc(var(--button-width) * 1);">
          <a href="letters_bookmarks.html">
            <div style="font-size: var(--def-fontsz); width:fit-content; height:calc(var(--button-width) * 0.7); min-width: calc(var(--button-width) * 1);" >
              <svg width="100%" height="100%">
                <svg width="100%" height="100%" version="1.1" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                 <path d="m24.06 5.3046v77.296l25.94-24.06 25.94 24.06v-77.296" fill="none" stroke="var(--main-color)" stroke-width="7"/>
                </svg>
                <!-- <use xlink:href="src/icons/login.svg#login_icon"></use> -->
              </svg>
              <!-- <img src="src/icons/bookmark.png" style='height: 100%; object-fit: contain;' id="favs_icon"/> -->
            </div>
          </a>
        </td>

        <td style="width:100%; float: center;">
          <center>
            <a href="letters.html" style="font-size: var(--def-fontsz);">На главную</a>
          </center>
        </td>

        <td style="width: fit-content">
          <button type="button" style="font-size: var(--def-fontsz); width:fit-content; height:calc(var(--button-width) * 0.7); min-width: calc(var(--button-width) * 1);" id="color_theme_button"> <img src="src/sun_moon2.jpg" style='height: 100%; object-fit: contain;' id="theme_icon"/> </button>
        </td>

        <td style="width: fit-content;">
          <button type="button" style="font-size: var(--def-fontsz); width:fit-content; height:calc(var(--button-width) * 0.7); min-width: calc(var(--button-width) * 1);" id="view_theme_button"> <img src="src/icons/default_dark.png" style='height: 100%; object-fit: contain; margin: auto;' id="view_icon"/> </button>
        </td>
      </tr>
    </table>
    <div id="username" style="display: none; text-align:left; padding-left: 0.5em; font-size: calc(var(--def-fontsz) * 0.85); color: var(--from-color);">
        silverfox123546576
    </div>
  </div>

  <div class="block" id="login_block" style="display:none; font-size:calc(var(--def-fontsz) * 0.5);">
    <br>
    <center>
      <div style="width: 92%;">
      <table>
        <tr>
          <td style="width: 30%; font-size:calc(var(--def-fontsz) * 0.7);">
            <center>
            Логин / почта:
            </center>
          </td>

          <td style="width: 5%;"></td>

          <td style="width: 30%; font-size:calc(var(--def-fontsz) * 0.7);">
            <center>
            Пароль:
          </center>
          </td>

          <td style="width: 5%;"></td>

          <td style="width: 30%; font-size: 0.7em;">
          </td>
        </tr>
        <tr>
          <td>
            <input type="text" autocomplete="username" class="input_text" name="user_nm" id="user_nm" style="font-size:calc(var(--def-fontsz) * 0.7); width: 100%;">
          </td>

          <td></td>

          <td style="font-size: 0.7em;">
            <input type="password" autocomplete="current-password" class="input_text" name="user_passwd" id="user_pswd" style="font-size:calc(var(--def-fontsz) * 0.7);  width: 100%;">
          </td>

          <td></td>

          <td style="font-size: 0.7em;">
            <button type="button" style="font-size:calc(var(--def-fontsz) * 0.9); width:100%;" id="login_button" onclick="tryLogin()"> Войти </button>
          </td>
        </tr>
      </table>
      <br>
      <div style="font-size:calc(var(--def-fontsz) * 0.7); width:fit-content; min-width: calc(var(--button-width) * 1);">
        Если ваш аккаунт привязан к ВК:
        <!-- VK Widget -->
        <div id="vk_auth"></div>
      </div>
      <br>
      <div style="font-size:calc(var(--def-fontsz) * 0.7); width:fit-content; min-width: calc(var(--button-width) * 1);">
        или
        <a href="registration.html" target="_blank" style="font-size:calc(var(--def-fontsz) * 0.7); width:fit-content; min-width: calc(var(--button-width) * 1);">зарегистрироваться</a>
      </div>
      <div id="login_errors" style="font-size:calc(var(--def-fontsz) * 0.7);"></div>
      </div>
      <br>
    </center>
  </div>

  <div class="block" id="logged_in_block" style="display:none; font-size:calc(var(--def-fontsz) * 0.7);">
    <center>
      <br>
      <button type="button" style="font-size:calc(var(--def-fontsz) * 0.9); width:9em;" id="logout_button" onclick="tryLogout()"> Выйти </button><br><br>
      Войдите через ВК, чтобы привязать аккаунт:
      <div id="vk_auth2"></div>
      <br>
    </center>
  </div>
</center>
</div>





























<br>

<div class="block">
<center><div style="width:90%;">
<center>
  <br>
    <div style="font-size: calc(var(--def-fontsz) * 1.2);">| Публикуем историю |<br>***</div>
    <div style="font-size: 0.5em;">
    <!-- <br> -->
    </div>
    <div style="font-size: calc(var(--def-fontsz) * 0.75); line-height: 1.2;">
        <b>
            Чтобы опубликовать историю,<br> необходимо авторизоваться<br><br>
            Вы будете отмечены как редактор
        </b>
    </div>
</center>
<hr>

<center>
    <div style='width: 100%; font-size: calc(0.85 * var(--def-fontsz));'>
        <div style="text-align: left;">
            Пишите группу вк - <a href="https://vk.com/letters_reader" target="_blank">Letters reader</a><br>
            <small style="color: var(--from-color);">Там есть редакторы, которые добавят вашу историю или помогут вам.</small>
            <br>
            Или можете добавить её сами на этой странице:
            <br>
            <hr>
            <center><h2>Название</h2></center>
            Полное название:<br>
            <input class="input_text" type="text" id="story_fullnm"><br>
            <small style="color: var(--from-color);">// так история будет называться на сайте</small>
            <br>
            <br>
            Название для адресной строки:<br>
            <input class="input_text" type="text" id="story_nm"><br>
            <small style="color: var(--from-color);">// используйте только прописные a-z и нижнее подчёркивание<br>// например: adam_eve</small>
            <br>
            <br>
            <br>
            <hr>
            <center><h2>Автор</h2></center>
            <!-- Использовать имя профиля на сайте:
            <input type="checkbox" class= "checkbox input_text" id="onsite_author"><br> -->
            Имя автора:<!--  (или его имя на сайте) --><br>
            <input class="input_text" type="text" id="author_name">
            <br>
            <br>
            Вы будете указаны в качестве редактора.
            <br>
            <br>
            <hr>
            <center><h2>Описание</h2></center>
            Короткое описание или примечание к тексту:<br>
            <small style="color: var(--from-color);">// его будет видно в карточке произведения, можете попробовать заинтересовать читателя</small><br>
            <textarea class="input_text" id="story_description" style="font-size: calc(var(--def-fontsz) * 0.7); min-height: calc(5 * var(--def-fontsz));overflow-y: scroll;" cols="50"></textarea>
            <br>
            <br>
            <hr>
            <center><h2>Текст в специальном формате</h2></center>
            Чтобы история выглядела как переписка, её нужно привести к определённому формату.<br>
            <small style="color: var(--from-color);">Вы можете прочитать про формат здесь:<br>
            <a href="https://obvious-broker-611.notion.site/1502aa7e698747b181cff3f3ca5ef9a8" target="_blank">Описание текстого формата</a><br>
            Вы можете посмотреть, как переписка будет выглядеть, здесь:<br>
            <a href="text_to_json.html">Предпросмотр</a><br></small>
            <br>
            <br>
            Текст:<br>
            <div>
            <textarea class="input_text" id="story_text" style="font-size: calc(var(--def-fontsz) * 0.7); min-height: calc(25 * var(--def-fontsz));overflow-y: scroll;" cols="50"></textarea></div>
            <!-- <input type="text" id="story_text"> -->
            <br><br>
            Нажмите, чтобы проверить, что текст правильно разбивается на сообщения:
            <button style="width: 80%; font-size: calc(var(--def-fontsz) * 1.2);" id="show_story_button" onclick="show_text()">Проверить текст</button>
            <br><br><br>
            <div id="text_collapse" style="width: 80%; text-align: left; height: 25rem; background: white; color: black; overflow: scroll;">no text</div>
            <br><br><br>
            Нажмите, чтобы добавить историю на сайт:
            <button style="width: 80%; font-size: calc(var(--def-fontsz) * 1.2); height: calc(var(--def-fontsz) * 2.5);" id="add_story_button" onclick="add_story()">Загрузить</button>
            <br><br>
        </div>
    </div>
    <br>
    <br>
</center>

Если текст не появляется на сайте без явных причин - обратитесь в группу вк (ссылка есть на главной странице сайта). Например, текст может быть слишком большим.
<br><br><br>
<div id="add_story_status"></div>
<br><br>


</div></center>

</div>
<br>
<br>
<br>
<br>
<div></div>
<script>
  window.color_theme = 1;
  window.view_theme = 1;
  tryRelogin();
</script>
<script src="src/letters_login.js"></script>
<script src="src/letters_themes.js">
</script>
<script src="src/letters_views.js">
</script>
<script src="src/letters_add_story.js">
</script>
<script src="src/vk_auth.js"></script>

</body>
</html>